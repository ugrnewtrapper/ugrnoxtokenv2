<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Teste de Compra – Wallet v12</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h2>Teste de Compra – Wallet v12</h2>

<label>
  Fixture ID:
  <input id="fixtureId" value="123456">
</label>

<br><br>

<button onclick="connect()">1️⃣ Conectar Carteira</button>
<button onclick="pay()">2️⃣ Pagar Análise</button>
<button onclick="unlock()">3️⃣ Liberar Análise</button>

<pre id="log"></pre>

<script type="module">
  // Importa a walletv12.js
  import './walletv12.js';

  function log(msg) {
    document.getElementById("log").textContent += msg + "\n";
  }

  async function connect() {
    try {
      const wallet = await window.walletv12.connectWallet();
      log("✅ Carteira conectada: " + wallet);
    } catch (e) {
      log("❌ Erro conectar: " + e.message);
    }
  }

  async function pay() {
    try {
      const res = await window.walletv12.payForAnalysis();
      log("✅ Pagamento OK: " + res.txHash);
    } catch (e) {
      log("❌ Erro pagamento: " + e.message);
    }
  }

  async function unlock() {
    try {
      const fixtureId = document.getElementById("fixtureId").value;
      const res = await window.walletv12.unlockAnalysis({ fixtureId });
      log("✅ Liberado: " + JSON.stringify(res));
    } catch (e) {
      log("❌ Erro unlock: " + e.message);
    }
  }
</script>

</body>
</html>
