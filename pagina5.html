<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>NOX Premium ‚Ä¢ An√°lises Avan√ßadas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --neon:#00ff9c;
  --dark:#020617;
  --soft:#94a3b8;
}

body{
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:
    radial-gradient(600px at top, rgba(0,255,156,.15), transparent 60%),
    linear-gradient(180deg, #020617, #01030f);
  color:#fff;
  min-height:100vh;
  padding:20px 10px 50px;
}

.container{
  width:100%;
  max-width:500px;
  margin:0 auto;
  background:linear-gradient(180deg, rgba(15,23,42,.95), rgba(2,6,23,.98));
  border-radius:22px;
  padding:24px 22px;
  box-shadow:
    0 24px 70px rgba(0,0,0,.7),
    inset 0 0 0 1px rgba(0,255,156,.18);
}

/* =============================
   NAVEGA√á√ÉO
============================= */

.nav-back{
  text-align:left;
  margin-bottom:10px;
}

.nav-back a{
  color:var(--neon);
  text-decoration:none;
  font-size:13px;
}

/* =============================
   HEADER
============================= */

.logo{
  max-width:110px;
  margin:6px auto 12px;
  display:block;
  filter:drop-shadow(0 0 10px rgba(0,255,156,.35));
}

h1{
  margin:4px 0 2px;
  font-size:22px;
  text-align:center;
}

.version{
  font-size:12px;
  color:var(--soft);
  text-align:center;
  margin-bottom:16px;
}

.info{
  font-size:13.5px;
  background:rgba(0,255,156,.08);
  padding:14px;
  border-radius:14px;
  line-height:1.55;
  border:1px solid rgba(0,255,156,.25);
  color:#c7fbe7;
  margin-bottom:16px;
}

/* =============================
   FORMUL√ÅRIO
============================= */

.form-group{
  margin-top:14px;
}

label{
  display:block;
  font-size:13px;
  color:var(--soft);
  margin-bottom:6px;
}

input{
  width:100%;
  height:44px;
  padding:0 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.08);
  background:rgba(2,6,23,.9);
  color:#fff;
  font-size:14px;
  box-sizing:border-box;
}

input[type="date"]{
  appearance:none;
  -webkit-appearance:none;
}

/* =============================
   BOT√ïES
============================= */

button{
  width:100%;
  height:46px;
  border-radius:16px;
  border:none;
  font-size:15px;
  font-weight:700;
  cursor:pointer;
  margin-top:12px;
}

button.primary{
  background:linear-gradient(135deg, #00ff9c, #00c777);
  color:#00150c;
  opacity:.45;
}

button.secondary{
  background:transparent;
  border:1px solid rgba(0,255,156,.5);
  color:var(--neon);
}

/* =============================
   LISTAGEM
============================= */

.results{
  margin-top:16px;
  text-align:left;
}

.competition{
  margin-bottom:12px;
}

.competition h3{
  cursor:pointer;
  color:var(--neon);
  margin-bottom:6px;
  font-size:14px;
}

.match{
  padding:7px 9px;
  border-radius:9px;
  cursor:pointer;
  font-size:13.5px;
}

.match:hover{
  background:rgba(0,255,156,.15);
}

.match.selected{
  background:rgba(0,255,156,.35);
  color:#00150c;
}

.status{
  margin-top:16px;
  background:rgba(255,0,0,.08);
  border:1px solid rgba(255,0,0,.35);
  color:#ffb4b4;
  padding:12px;
  border-radius:12px;
  font-size:13px;
  text-align:center;
}

/* =============================
   M√âTRICAS
============================= */

.metrics{
  margin-top:20px;
  display:grid;
  gap:10px;
}

.metric-card{
  background:rgba(0,255,156,.06);
  border:1px solid rgba(0,255,156,.25);
  border-radius:14px;
  padding:12px;
}

.metric-card h4{
  margin:0 0 6px;
  font-size:13.5px;
  color:var(--neon);
}

.metric-card p{
  margin:0;
  font-size:12.5px;
  color:#c7fbe7;
  line-height:1.45;
}
</style>
</head>

<body>
<div class="container">

<div class="nav-back">
  <a href="index.html">‚Üê Voltar para in√≠cio</a>
</div>

<img src="images/logo.png" class="logo">

<h1>NOX Premium</h1>
<div class="version">P√°gina 5 ‚Ä¢ v1.3</div>

<div class="info">
üîê Utilize esta p√°gina no <strong>navegador da sua carteira</strong>.<br>
üí° Cada pagamento libera <strong>1 an√°lise Premium</strong>.
</div>

<div class="form-group">
  <label>API Key ‚Ä¢ API-Football</label>
  <input id="apikey" type="text" placeholder="Cole sua API Key">
</div>

<div class="form-group">
  <label>Data da an√°lise</label>
  <input id="date" type="date">
</div>

<button class="secondary" onclick="loadCompetitions()">üìÖ Carregar Partidas</button>

<div id="competitions" class="results"></div>

<!-- üîΩ ADI√á√ÉO NECESS√ÅRIA (SEM REMOVER NADA) -->
<button id="payBtn" class="secondary">
üí≥ Efetuar Pagamento Premium
</button>

<div class="status" id="paymentStatus">
üîí Acesso Premium bloqueado. Efetue o pagamento.
</div>

<!-- üîΩ MESMO BOT√ÉO, APENAS COM ID -->
<button id="analyzeBtn" class="primary" onclick="analyzeMatch()">üîé Analisar Partida</button>

<div class="metrics" id="results">

  <div class="metric-card">
    <h4>üë§ Jogadores</h4>
    <p>Finaliza√ß√µes, cart√µes e participa√ß√£o direta.</p>
  </div>

  <div class="metric-card">
    <h4>üü® Cart√µes</h4>
    <p>M√©dias por equipe, √°rbitro e disciplina.</p>
  </div>

  <div class="metric-card">
    <h4>üö© Escanteios</h4>
    <p>Press√£o ofensiva e volume de ataque.</p>
  </div>

</div>

</div>

<script>
const BACKEND_LIST = "https://backendnoxv2.srrimas2017.workers.dev";
let selectedFixture = null;

async function loadCompetitions(){
  const apiKey = apikey.value;
  const dateVal = date.value;
  const box = competitions;

  box.innerHTML = "‚è≥ Carregando...";

  const res = await fetch(BACKEND_LIST,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ apiKey, date:dateVal })
  });

  const data = await res.json();
  let html = "";

  data.competitions.forEach((c,i)=>{
    html+=`<div class="competition">
      <h3 onclick="toggleComp(${i},event)">üèÜ ${c.league}</h3>
      <div id="c-${i}">`;
    c.matches.forEach(m=>{
      html+=`<div class="match" data-fixture="${m.fixtureId}"
        onclick="selectMatch(event,this)">
        ${m.time} ${m.home} x ${m.away}
      </div>`;
    });
    html+=`</div></div>`;
  });

  box.innerHTML = html;
}

function toggleComp(i,e){
  e.stopPropagation();
  const el=document.getElementById("c-"+i);
  el.style.display = el.style.display==="none" ? "block" : "none";
}

function selectMatch(e,el){
  e.stopPropagation();
  document.querySelectorAll(".match").forEach(m=>m.classList.remove("selected"));
  el.classList.add("selected");
  selectedFixture = el.dataset.fixture;
}
</script>

<script type="module" src="money/walletv12.js"></script>
<script src="statistics/statistics.js"></script>

<script>
/* =============================
   ATIVA√á√ÉO AUTOM√ÅTICA DO BOT√ÉO
   AP√ìS PAGAMENTO CONFIRMADO
   (SEM DEPENDER DO WALLET)
============================= */

document.addEventListener("DOMContentLoaded", () => {
  const statusEl = document.getElementById("paymentStatus");
  const analyzeBtn = document.getElementById("analyzeBtn");

  if (!statusEl || !analyzeBtn) return;

  const unlock = () => {
    analyzeBtn.style.opacity = "1";
    analyzeBtn.style.cursor = "pointer";
    analyzeBtn.disabled = false;
  };

  const lock = () => {
    analyzeBtn.style.opacity = ".45";
    analyzeBtn.style.cursor = "not-allowed";
    analyzeBtn.disabled = true;
  };

  // estado inicial
  lock();

  const observer = new MutationObserver(() => {
    const text = statusEl.innerText.toLowerCase();
    if (!text.includes("bloqueado")) {
      unlock();
    }
  });

  observer.observe(statusEl, {
    childList: true,
    subtree: true,
    characterData: true
  });
});
</script>
  
</body>
</html>
