<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>TESTE TEMPOR√ÅRIO ‚Äî WORKER V24</title>

<style>
body {
  background:#0f1216;
  color:#e6e6e6;
  font-family:monospace;
  padding:20px;
}
h1 { color:#ffb300; font-size:20px }
.box {
  border:1px dashed #444;
  background:#151a21;
  padding:12px;
  margin-bottom:12px;
}
.ok { color:#4caf50 }
.err { color:#f44336 }
pre {
  background:#0b0e12;
  padding:10px;
  font-size:12px;
  overflow:auto;
}
</style>
</head>

<body>

<h1>üß™ TESTE TEMPOR√ÅRIO ‚Äî BACKEND CENTRAL (V24)</h1>
<p>
Arquivo isolado para validar fluxo, valida√ß√µes e respostas do worker.<br>
Depend√™ncias WalletV24 / StatisticsV24 N√ÉO s√£o implementadas aqui.
</p>

<div id="out"></div>

<script>
/* ======================================================
   CONFIGURA√á√ÉO
   ====================================================== */

const BACKEND_URL = "backendv12.srrimas2017.workers.dev"; // üî¥ ajuste

const API_KEY_FAKE = "xxxxxxxxxxxxxxxxxxxxFAKEKEY";

/* Payloads de teste ‚Äî respeitam o contrato real */
const TESTS = [
  {
    name: "‚ùå M√©todo inv√°lido (GET)",
    method: "GET",
    body: null
  },
  {
    name: "‚ùå Payload vazio",
    method: "POST",
    body: null
  },
  {
    name: "‚ùå API Key inv√°lida",
    method: "POST",
    body: { step:"competitions", apiKey:"123", date:"2024-01-01" }
  },
  {
    name: "‚úÖ Step competitions",
    method: "POST",
    body: {
      step:"competitions",
      apiKey:API_KEY_FAKE,
      date:"2024-01-01"
    }
  },
  {
    name: "‚úÖ Step fixtures",
    method: "POST",
    body: {
      step:"fixtures",
      apiKey:API_KEY_FAKE,
      date:"2024-01-01",
      competitionId:39
    }
  },
  {
    name: "‚úÖ Step payment",
    method: "POST",
    body: {
      step:"payment",
      apiKey:API_KEY_FAKE,
      fixtureId:123456,
      paymentData:{ mock:true }
    }
  },
  {
    name: "‚ùå Step analysis sem pagamento confirmado",
    method: "POST",
    body: {
      step:"analysis",
      apiKey:API_KEY_FAKE,
      fixtureId:123456,
      paymentData:{ mock:true }
    }
  },
  {
    name: "‚ùå Step inexistente",
    method: "POST",
    body: {
      step:"banana",
      apiKey:API_KEY_FAKE
    }
  }
];

/* ======================================================
   EXECUTOR DE TESTES
   ====================================================== */

async function run(test) {
  const box = document.createElement("div");
  box.className = "box";
  box.innerHTML = `<strong>${test.name}</strong><br>Executando...`;
  out.appendChild(box);

  try {
    const res = await fetch(BACKEND_URL, {
      method: test.method,
      headers: { "Content-Type":"application/json" },
      body: test.body ? JSON.stringify(test.body) : null
    });

    const txt = await res.text();
    let json;
    try { json = JSON.parse(txt); } catch { json = txt; }

    box.innerHTML = `
      <strong>${test.name}</strong><br>
      Status: <span class="${res.ok?"ok":"err"}">${res.status}</span>
      <pre>${JSON.stringify(json,null,2)}</pre>
    `;
  } catch (e) {
    box.innerHTML = `
      <strong>${test.name}</strong><br>
      <span class="err">ERRO DE REDE</span>
      <pre>${e.message}</pre>
    `;
  }
}

/* ======================================================
   EXECU√á√ÉO AUTOM√ÅTICA
   ====================================================== */

(async()=>{
  for (const t of TESTS) await run(t);
})();
</script>

</body>
</html>
