<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Teste REAL â€“ walletv12</title>
</head>
<body>

<h2>ğŸ’³ Teste REAL â€” Pagamento + AnÃ¡lise</h2>
<button id="btn">Pagar e Liberar AnÃ¡lise</button>
<pre id="log"></pre>

<script type="module">
import { payAndAnalyze } from "./money/walletv12.js";

const API_KEY = "44154acf83f7568c7b0e75e10676a2dd";
const BACKEND_ANALYSIS = "https://backendv12.srrimas2017.workers.dev/analysis";

const logEl = document.getElementById("log");
const log = (m) => logEl.textContent += m + "\n";

document.getElementById("btn").onclick = async () => {
  logEl.textContent = "";

  try {
    // ğŸ”¹ Fixture FIXO para teste real (sem depender de /competitions)
    const fixtureId = 215663;

    log("ğŸ¯ Fixture de teste:");
    log(String(fixtureId));
    log("ğŸ’³ Iniciando pagamento REAL on-chain...");
    log("â›“ï¸ MetaMask serÃ¡ solicitada");

    const result = await payAndAnalyze({
      apiKey: API_KEY,
      fixtureId,
      backendUrl: BACKEND_ANALYSIS
    });

    log("âœ… FLUXO COMPLETO FINALIZADO");
    log(JSON.stringify(result, null, 2));

  } catch (err) {
    log("âŒ ERRO NO FLUXO:");
    log(err.message || err);
    console.error(err);
  }
};
</script>

</body>
</html>
