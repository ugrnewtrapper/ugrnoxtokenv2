<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>NOX Football Analytics ‚Ä¢ v0.3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --blue:#0a4cff;
  --blue-dark:#0836b3;
  --bg:#f4f7fb;
  --card:#ffffff;
  --text:#0f172a;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  text-align:center;
}

header{
  background:linear-gradient(135deg,var(--blue),var(--blue-dark));
  padding:22px;
  color:#fff;
  animation:fadeDown .6s ease;
}

header img{
  max-height:64px;
  margin-bottom:10px;
}

main{
  max-width:1000px;
  margin:30px auto;
  padding:0 20px;
}

.card{
  background:var(--card);
  border-radius:16px;
  padding:22px;
  margin-bottom:22px;
  box-shadow:0 12px 30px rgba(0,0,0,.08);
  animation:fadeUp .6s ease;
}

input,button{
  padding:12px 14px;
  margin:8px;
  border-radius:12px;
  border:1px solid #cbd5e1;
  font-size:15px;
}

button{
  background:var(--blue);
  color:#fff;
  border:none;
  cursor:pointer;
  transition:.3s;
}

button:hover{
  background:var(--blue-dark);
  transform:scale(1.05);
}

.competition{
  margin-top:16px;
  text-align:left;
}

.comp-title{
  font-weight:700;
  margin:18px 0 8px;
}

.match{
  padding:10px;
  border-radius:10px;
  margin-top:6px;
  background:#eef2ff;
  cursor:pointer;
  transition:.25s;
}

.match:hover{
  background:#dbeafe;
  transform:translateX(6px);
}

.match.selected{
  background:var(--blue);
  color:#fff;
}

.result{
  font-size:16px;
  margin-top:6px;
}

nav{
  margin:30px 0;
}

nav a{
  text-decoration:none;
  color:var(--blue);
  font-weight:600;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:translateY(0)}
}

@keyframes fadeDown{
  from{opacity:0;transform:translateY(-20px)}
  to{opacity:1;transform:translateY(0)}
}
</style>
</head>

<body>

<header>
  <img src="images/logo.png" alt="NOX Logo">
  <h1>‚öΩ NOX Football Analytics</h1>
  <p>H2H ‚Ä¢ M√©dias ‚Ä¢ Estat√≠stica Avan√ßada</p>
</header>

<main>

  <div class="card">
    <h2>üîê Configura√ß√£o</h2>
    <input id="apiKey" placeholder="API Key API-Football">
    <input id="date" type="date">
    <br>
    <button onclick="loadCompetitions()">üìÖ Carregar Competi√ß√µes</button>
  </div>

  <div class="card">
    <h2>üèÜ Competi√ß√µes & Partidas</h2>
    <div id="competitions">Nenhuma competi√ß√£o carregada.</div>
  </div>

  <div class="card">
    <h2>üìä An√°lise da Partida</h2>
    <button onclick="analyzeMatch()">‚ö° Analisar Partida</button>
    <div id="analysis"></div>
  </div>

  <nav>
    <a href="index.html">‚¨Ö Index ‚Ä¢ P√°gina Inicial</a>
  </nav>

</main>

<script>
const BACKEND_URL = "https://backendnoxv2.srrimas2017.workers.dev/";
let selectedFixture = null;

async function loadCompetitions(){
  const apiKey = document.getElementById("apiKey").value;
  const date = document.getElementById("date").value;
  const box = document.getElementById("competitions");

  if(!apiKey || !date){
    alert("Informe API Key e Data");
    return;
  }

  box.innerHTML = "‚è≥ Carregando competi√ß√µes...";

  const res = await fetch(BACKEND_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ apiKey, date })
  });

  const data = await res.json();
  box.innerHTML = "";

  if(!data.competitions?.length){
    box.innerHTML = "Nenhuma competi√ß√£o encontrada.";
    return;
  }

  data.competitions.forEach(c=>{
    const div=document.createElement("div");
    div.className="competition";
    div.innerHTML=`<div class="comp-title">üèÜ ${c.league} (${c.country})</div>`;

    c.matches.forEach(m=>{
      const md=document.createElement("div");
      md.className="match";
      md.textContent=`‚öΩ ${m.home} vs ${m.away} ‚Äî ${m.time}`;
      md.onclick=()=>{
        document.querySelectorAll(".match").forEach(x=>x.classList.remove("selected"));
        md.classList.add("selected");
        selectedFixture=m.fixtureId;
      };
      div.appendChild(md);
    });

    box.appendChild(div);
  });
}

async function analyzeMatch(){
  if(!selectedFixture){
    alert("Selecione uma partida.");
    return;
  }

  const apiKey=document.getElementById("apiKey").value;
  const date=document.getElementById("date").value;
  const out=document.getElementById("analysis");

  out.innerHTML="‚è≥ Analisando partida...";

  const res=await fetch(BACKEND_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ apiKey, date, fixtureId:selectedFixture })
  });

  const data=await res.json();
  out.innerHTML="";

  if(!data.means){
    out.innerHTML="Sem dados para an√°lise.";
    return;
  }

  out.innerHTML+=`<p><strong>${data.home} vs ${data.away}</strong></p>`;
  out.innerHTML+=`<p>üìà Jogos H2H: ${data.h2hGames}</p>`;

  for(const k in data.means){
    out.innerHTML+=`<div class="result">üìä ${k}: <strong>${data.means[k]}</strong></div>`;
  }
}
</script>

</body>
</html>
