<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>NOX Football Analytics ‚öΩ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  background: linear-gradient(135deg, #0a2cff, #0d6efd);
  color: #fff;
  text-align: center;
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 20px;
}

.logo {
  max-width: 180px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

h1 {
  margin-top: 10px;
}

p {
  opacity: 0.9;
}

input, button {
  padding: 12px;
  margin: 8px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}

input {
  width: 260px;
}

button {
  background: #00d4ff;
  color: #003;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s, background 0.2s;
}

button:hover {
  background: #00ffff;
  transform: scale(1.05);
}

.section {
  margin-top: 25px;
  background: rgba(255,255,255,0.1);
  padding: 15px;
  border-radius: 12px;
}

.competition {
  margin-top: 10px;
  text-align: left;
}

.competition h3 {
  cursor: pointer;
  color: #00ffff;
}

.match {
  margin-left: 15px;
  cursor: pointer;
  padding: 5px;
}

.match:hover {
  background: rgba(255,255,255,0.15);
}

.selected {
  background: rgba(0,255,255,0.3);
}

.footer {
  margin-top: 40px;
  font-size: 14px;
  opacity: 0.8;
}

a {
  color: #00ffff;
  text-decoration: none;
  font-weight: bold;
}
</style>
</head>

<body>

<div class="container">

<img src="images/logo.png" class="logo" alt="NOX Logo">

<h1>NOX Football Analytics ‚öΩüìä</h1>

<p>
Plataforma profissional para an√°lise de partidas de futebol.<br>
Conectada em tempo real com a <strong>API-Football</strong> e motor estat√≠stico avan√ßado.
</p>

<div class="section">
  <input type="text" id="apiKey" placeholder="üîë Sua API Key">
  <input type="date" id="date">
  <br>
  <button onclick="loadCompetitions()">üìÖ Carregar Competi√ß√µes</button>
</div>

<div id="competitions" class="section"></div>

<div class="section">
  <button onclick="analyzeMatch()">üìä Analisar Partida</button>
</div>

<div id="result" class="section"></div>

<div class="section">
  <button onclick="location.href='index.html'">üè† P√°gina Inicial</button>
  <br><br>
  <a href="https://www.api-football.com/" target="_blank">‚û°Ô∏è Criar API Football</a>
</div>

<div class="footer">
  Vers√£o 1.0 Pro üöÄ
</div>

</div>

<script>
const BACKEND = "https://backendnoxv2.srrimas2017.workers.dev/";
let selectedFixture = null;

async function loadCompetitions() {
  document.getElementById("competitions").innerHTML = "‚è≥ Carregando...";
  selectedFixture = null;

  const apiKey = document.getElementById("apiKey").value;
  const date = document.getElementById("date").value;

  const res = await fetch(BACKEND, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ apiKey, date })
  });

  const data = await res.json();

  if (!data.competitions) {
    document.getElementById("competitions").innerHTML = "‚ùå Nenhuma competi√ß√£o encontrada";
    return;
  }

  let html = "";
  data.competitions.forEach(comp => {
    html += `
      <div class="competition">
        <h3 onclick="toggleComp(this)">üèÜ ${comp.league} (${comp.country})</h3>
        <div>
    `;
    comp.matches.forEach(m => {
      html += `
        <div class="match" onclick="selectMatch(this, ${m.fixtureId})">
          ‚è∞ ${m.time} - ${m.home} x ${m.away}
        </div>
      `;
    });
    html += `</div></div>`;
  });

  document.getElementById("competitions").innerHTML = html;
}

function toggleComp(el) {
  const div = el.nextElementSibling;
  div.style.display = div.style.display === "none" ? "block" : "none";
}

function selectMatch(el, fixtureId) {
  document.querySelectorAll(".match").forEach(m => m.classList.remove("selected"));
  el.classList.add("selected");
  selectedFixture = fixtureId;

  document.querySelectorAll(".competition div").forEach(d => d.style.display = "none");
}

async function analyzeMatch() {
  if (!selectedFixture) {
    alert("Selecione uma partida ‚ö†Ô∏è");
    return;
  }

  document.getElementById("result").innerHTML = "üìä Analisando...";

  const apiKey = document.getElementById("apiKey").value;
  const date = document.getElementById("date").value;

  const res = await fetch(BACKEND, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ apiKey, date, fixtureId: selectedFixture })
  });

  const data = await res.json();

  let html = `<h3>${data.home} x ${data.away}</h3>`;
  html += `<p>Jogos H2H analisados: ${data.h2hGames}</p><ul>`;

  for (const k in data.means) {
    html += `<li>${k}: <strong>${data.means[k]}</strong></li>`;
  }

  html += "</ul>";

  document.getElementById("result").innerHTML = html;
}
</script>

</body>
</html>
